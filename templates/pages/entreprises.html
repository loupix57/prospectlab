{% extends "base.html" %}

{% block title %}Entreprises - ProspectLab{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Entreprises analysées</h1>
    <p>Gérez vos prospects, ajoutez des tags et des notes</p>
</div>

<div class="filters-section">
    <div class="filters-card">
        <h3>Filtres et recherche</h3>
        
        <div class="filters-grid">
            <div class="filter-group">
                <label for="search-input">Recherche</label>
                <input type="text" id="search-input" placeholder="Nom, secteur, email..." class="form-input">
            </div>
            
            <div class="filter-group">
                <label for="filter-secteur">Secteur</label>
                <select id="filter-secteur" class="form-select">
                    <option value="">Tous les secteurs</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="filter-statut">Statut</label>
                <select id="filter-statut" class="form-select">
                    <option value="">Tous les statuts</option>
                    <option value="Prospect intéressant">Prospect intéressant</option>
                    <option value="À contacter">À contacter</option>
                    <option value="En cours">En cours</option>
                    <option value="Clos">Clos</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="filter-opportunite">Opportunité</label>
                <select id="filter-opportunite" class="form-select">
                    <option value="">Toutes les opportunités</option>
                    <option value="Élevée">Élevée</option>
                    <option value="Moyenne">Moyenne</option>
                    <option value="Faible">Faible</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>
                    <input type="checkbox" id="filter-favori">
                    Favoris uniquement
                </label>
            </div>
        </div>
        
        <div class="filters-actions">
            <button id="btn-apply-filters" class="btn btn-primary">Appliquer</button>
            <button id="btn-reset-filters" class="btn btn-secondary">Réinitialiser</button>
            <button id="btn-export" class="btn btn-success">Exporter</button>
        </div>
    </div>
</div>

<div class="results-section">
    <div class="results-header">
        <h3 id="results-count">Chargement...</h3>
        <div class="view-options">
            <button id="btn-view-grid" class="view-btn active" title="Vue grille">
                <i class="fas fa-th"></i>
            </button>
            <button id="btn-view-list" class="view-btn" title="Vue liste">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>
    
    <div id="entreprises-container" class="entreprises-grid">
        <p>Chargement des entreprises...</p>
    </div>
    
    <div id="pagination" class="pagination"></div>
</div>

<!-- Modale de détails d'entreprise -->
<div id="entreprise-modal" class="modal" style="display: none;">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h2 id="modal-entreprise-nom">Chargement...</h2>
            <button class="modal-close" id="modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body" id="modal-entreprise-body">
            <div class="loading">Chargement des détails...</div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Modules utilitaires (chargement synchrone pour dépendances) -->
<script src="{{ url_for('static', filename='js/modules/utils/formatters.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/utils/badges.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/utils/notifications.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/utils/debounce.js') }}"></script>
<!-- Module API -->
<script src="{{ url_for('static', filename='js/modules/entreprises/api.js') }}"></script>
<!-- Modules d'affichage des analyses -->
<script src="{{ url_for('static', filename='js/modules/analyses/technical.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/analyses/osint.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/analyses/pentest.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/analyses/scraping.js') }}"></script>
<!-- Script principal (chargement différé) -->
<script src="{{ url_for('static', filename='js/entreprises.refactored.js') }}" defer></script>
{% endblock %}

